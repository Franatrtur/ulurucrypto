/**
 * **LICENSED UNDER THE MIT LICENSE:**
 * @license https://github.com/Franatrtur/ulurucrypto/blob/main/LICENSE
 */
var Uluru,crypto="object"==typeof crypto?crypto:function(){var e=require("crypto");return{getRandomValues:t=>(e.randomFillSync(t),t)}}();!function(e){let t;!function(e){e.Ascii=class{encode(e){let t=new Uint8Array(e.length);for(let n=0,r=e.length;n<r;n++)t[n]=e.charCodeAt(n);return t}decode(e){e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);let t=Array(e.length);for(let n=0,r=e.length;n<r;n++)t[n]=String.fromCharCode(e[n]);return t.join("")}}}(t=e.enc||(e.enc={}))}(Uluru||(Uluru={})),function(e){let t;!function(e){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",n=["","=","=="],r=new Uint8Array(256);for(let e=0;e<64;e++)r[t.charCodeAt(e)]=e;e.Base64=class{encode(t){if("function"==typeof atob)return(new e.Ascii).encode(atob(t));let n,i,a=3*(t=t.replace(/[^A-Za-z0-9\+\/]/g,"")).length+1>>>2,s=new Uint8Array(a),c=0,o=0;for(let e=0,f=t.length;e<f;e++)if(i=3&e,c|=r[t.charCodeAt(e)]<<6*(3-i),3==i||t.length-e==1){for(n=0;n<3&&o<a;n++,o++)s[o]=c>>>(16>>>n&24)&255;c=0}return s}decode(r){if(r=new Uint8Array(r.buffer,r.byteOffset,r.byteLength),"function"==typeof btoa)return btoa((new e.Ascii).decode(r));let i=[],a=2,s=0;for(let e=0,n=r.length;e<n;e++)a=e%3,s|=r[e]<<(16>>>a&24),2!=a&&r.length-e!=1||(i.push(t.charAt(s>>>18&63)+t.charAt(s>>>12&63)+t.charAt(s>>>6&63)+t.charAt(63&s)),s=0);return i=i.join(""),i.slice(0,i.length-2+a)+n[2-a]}}}(t=e.enc||(e.enc={}))}(Uluru||(Uluru={})),function(e){const t=new Uint32Array((new e.enc.Ascii).encode("expand 32-byte k").buffer);e.ChaCha20=class{constructor(e,n=!0,r=new Uint32Array(3),i=0){this.state=new Uint32Array(16),this.state.set(t),this.state.set(new Uint32Array(e.buffer,e.byteOffset,e.byteLength>>2),4),this.state.set(new Uint32Array(r.buffer,r.byteOffset,r.byteLength>>2),12);for(let e=0;e<8;e++){for(let e=0;e<4;e++)this.QR(this.state,e,e+4,e+8,e+12);for(let e=0;e<16;e+=4)this.QR(this.state,e,e+1,e+2,e+3)}this.prectr=this.state[15],this.state[15]^=i,this.ctr=i,this.domac=!!n,this.reset()}reset(){this.xstate=new Uint32Array(16),this.pmac=!!this.domac&&new Uint32Array(t),this.cmac=!!this.domac&&new Uint32Array(t),this.data=new Uint32Array(0),this.pointer=0,this.sigbytes=0}QR(e,t,n,r,i){e[t]+=e[n],e[i]^=e[t],e[i]=e[i]<<16|e[i]>>>16,e[r]+=e[i],e[n]^=e[r],e[n]=e[n]<<12|e[n]>>>20,e[t]+=e[n],e[i]^=e[t],e[i]=e[i]<<8|e[i]>>>24,e[r]+=e[i],e[n]^=e[r],e[n]=e[n]<<7|e[n]>>>25}getmac(){if(!this.domac)return!1;let e=this.pmac,t=this.cmac,n=new Uint32Array([e[0]^t[0],e[1]^t[1],e[2]^t[2],e[3]^t[3]]);for(let e=0;e<4;e++)this.QR(n,0,1,2,3),this.QR(n,3,0,1,2),this.QR(n,2,3,0,1),this.QR(n,1,2,3,0);for(let r=0;r<4;r++)n[r]+=e[r]+t[r];return new Uint8Array(n.buffer)}process(e=!1){let t,n,r=(e?Math.ceil:Math.floor)((this.sigbytes-this.pointer)/16),i=Math.ceil(this.sigbytes/4)-1,a=4-this.sigbytes%4;this.state[15]=this.prectr^this.ctr+(this.pointer>>4);for(let e=0;e<r;e++){let e=this.xstate;e.set(this.state);for(let t=0;t<20;t+=2)this.QR(e,0,4,8,12),this.QR(e,1,5,9,13),this.QR(e,2,6,10,14),this.QR(e,3,7,11,15),this.QR(e,0,5,10,15),this.QR(e,1,6,11,12),this.QR(e,2,7,8,13),this.QR(e,3,4,9,14);for(let e=0;e<16&&this.pointer+e<=i;e++)t=this.data[this.pointer+e],n=t^this.xstate[e]+this.state[e],this.pointer+e==i&&(n=n<<8*a>>>8*a),this.data[this.pointer+e]=n,this.domac&&(this.pmac[3&e]^=t+this.xstate[e],this.cmac[3&e]^=n+this.xstate[e],this.QR(this.pmac,3&e,e+1&3,e+2&3,e+3&3),this.QR(this.cmac,3&e,e+1&3,e+2&3,e+3&3));this.pointer+=16,this.state[15]++}}append(t){t="string"==typeof t?(new e.enc.Utf8).encode(t):t;let n=this.data,r=64*Math.ceil((this.sigbytes+t.byteLength)/64);this.data=new Uint8Array(r),this.data.set(new Uint8Array(n.buffer,0,this.sigbytes)),this.data.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),this.sigbytes),this.data=new Uint32Array(this.data.buffer),this.sigbytes+=t.byteLength}update(e){return this.append(e),this.process(!1),this}finalize(){return this.process(!0),{data:new Uint8Array(this.data.buffer,0,this.sigbytes),mac:this.getmac()}}}}(Uluru||(Uluru={})),function(e){e.encrypt=function(t,n){let r=(new e.Random).fill(new Uint8Array(6)),i=new e.Pbkdf(32,1e3).compute((new e.enc.Utf8).encode(n),r).result,a=new e.ChaCha20(i,!0,r);a.update((new e.enc.Utf8).encode(t));let s=a.finalize();return(new e.enc.Hex).decode(r)+(new e.enc.Base64).decode(s.data)+(new e.enc.Hex).decode(s.mac)},e.decrypt=function(t,n){let r,i,a;try{r=(new e.enc.Hex).encode(t.slice(0,12)),i=(new e.enc.Base64).encode(t.slice(12,-32)),a=t.slice(-32)}catch(e){throw"Incorrectly formated ciphertext"}let s=new e.Pbkdf(32,1e3).compute((new e.enc.Utf8).encode(n),r).result,c=new e.ChaCha20(s,!0,r);c.update(i);let o=c.finalize();if((new e.enc.Hex).decode(o.mac)!=a)throw"Invalid authentication";return(new e.enc.Utf8).decode(o.data)},e.hash=function(t){return(new e.Keccak800).update((new e.enc.Utf8).encode(t)).finalize().toString(new e.enc.Hex)},e.rsaGenerate=function(){return e.RSAKeyPair.generate(3072).toString()},e.rsaSign=function(t,n){return(new e.enc.Base64).decode(e.RSAKey.fromString(n).sign((new e.enc.Utf8).encode(t)).signature)},e.rsaVerify=function(t,n,r){return e.RSAKey.fromString(r).verify((new e.enc.Utf8).encode(t),(new e.enc.Base64).encode(n))},e.rsaEncrypt=function(t,n){let r=e.RSAKey.fromString(n),i=(new e.Random).fill(new Uint8Array(32)),a=(new e.enc.Base64).decode(r.encrypt(i).data),s=new e.ChaCha20(i,!0).update((new e.enc.Utf8).encode(t)).finalize();return a+"|"+(new e.enc.Base64).decode(s.data)+(new e.enc.Hex).decode(s.mac)},e.rsaDecrypt=function(t,n){let r,i,a,s,c;try{r=e.RSAKey.fromString(n),c=t.split("|"),i=(new e.enc.Base64).encode(c[0]),a=(new e.enc.Base64).encode(c[1].slice(0,-32)),s=(new e.enc.Hex).encode(c[1].slice(-32))}catch(e){throw"Incorrectly formatted RSA ciphertext"}if(i=r.decrypt(i).data,a=new e.ChaCha20(i,!0).update(a).finalize(),a.mac.join(",")!=s.join(","))throw"Invalid RSA message authentication code";return(new e.enc.Utf8).decode(a.data)}}(Uluru||(Uluru={})),function(e){let t;!function(e){let t=Array(256),n={};for(let e=0;e<256;e++)t[e]=("00"+e.toString(16)).slice(-2),n[t[e]]=e;e.Hex=class{encode(e){e=e.replace(/[^A-Fa-f0-9\+\/]/g,"").toLowerCase();let t=new Uint8Array(e.length>>1);for(let r=0;r<e.length;r+=2)t[r>>1]=n[e.slice(r,r+2)];return t}decode(e){e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength);let n=Array(e.length);for(let r=0;r<e.length;r++)n[r]=t[e[r]];return n.join("")}}}(t=e.enc||(e.enc={}))}(Uluru||(Uluru={})),function(e){const t=new Uint8Array([0,1,62,28,27,36,44,6,55,20,3,10,43,25,39,41,45,15,21,8,18,2,61,56,14]),n=new Uint32Array([1,32898,32906,2147516416,32907,2147483649,2147516545,32777,138,136,2147516425,2147483658,2147516555,139,32905,32771,32770,128,32778,2147483658,2147516545,32896,2147483649,2147516424]),r=new Uint8Array(25),i=new Uint8Array(25),a=new Uint8Array(25),s=new Uint8Array(25),c=new Uint8Array(25);let o,f;for(let e=0;e<25;e++)o=e%5,f=Math.floor(e/5),r[e]=(o+1)%5,i[e]=(o+4)%5,a[e]=5*f+(2*o+3*f)%5,s[e]=(o+1)%5*5+f,c[e]=(o+2)%5*5+f;e.Keccak800=class{constructor(){this.reset()}reset(){this.state=new Uint32Array(25),this.temp=new Uint32Array(25),this.theta=new Uint32Array(5),this.data=new Uint32Array(0),this.pointer=0,this.padblock=new Uint32Array(16),this.padsigbytes=0}keccakF(e){let o,f,h=this.temp,u=this.theta;for(let l=0;l<22;l++){u[0]=e[0]^e[1]^e[2]^e[3]^e[4],u[1]=e[5]^e[6]^e[7]^e[8]^e[9],u[2]=e[10]^e[11]^e[12]^e[13]^e[14],u[3]=e[15]^e[16]^e[17]^e[18]^e[19],u[4]=e[20]^e[21]^e[22]^e[23]^e[24];for(let n=0;n<25;n++)f=u[r[n]],e[n]^=u[i[n]]^(f<<1|f>>>31),o=t[n],f=e[n],h[a[n]]=f<<o|f>>>32-o;for(let t=0;t<25;t++)e[t]=h[t]^~h[s[t]]&h[c[t]];e[0]^=n[l]}}process(e=!1){let t=(this.data.length-this.pointer)/16;for(let e=0;e<t;e++){for(let e=0;e<16;e++)this.state[e]^=this.data[this.pointer+e];this.keccakF(this.state),this.pointer+=16}if(e){for(let e=0;e<16;e++)this.state[e]^=this.padblock[e];this.keccakF(this.state)}}append(t){t="string"==typeof t?(new e.enc.Utf8).encode(t):t;let n=this.padblock,r=this.padsigbytes;if(t.byteLength+r<64)n=new Uint8Array(n.buffer),n.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength),r),n[n.length-1]=128,n[t.byteLength+r]^=6,this.padblock=new Uint32Array(n.buffer),this.padsigbytes+=t.byteLength;else{let e=r+t.byteLength>>6<<6,i=(r+t.byteLength)%64;this.data=this.data.byteLength>e?new Uint8Array(this.data.buffer,0,e):new Uint8Array(e),this.data.set(new Uint8Array(n.buffer,0,r)),this.data.set(new Uint8Array(t.buffer,t.byteOffset,t.byteLength-i),r),this.data=new Uint32Array(this.data.buffer,0,e>>2),n.fill(0),this.padsigbytes=0,this.append(new Uint8Array(t.buffer,t.byteOffset+t.byteLength-i,i))}}update(e){return this.append(e),this.process(!1),this}finalize(t=32){this.process(!0);let n=16*Math.ceil(t/64),r=new Uint32Array(n);for(let e=0;e<n;e+=16)r.set(new Uint32Array(this.state.buffer,0,16),e),this.keccakF(this.state);return{toString(t=new e.enc.Hex){return t.decode(this.hash)},hash:new Uint8Array(r.buffer,0,t)}}}}(Uluru||(Uluru={})),function(e){const t=32;function n(...e){let t=0;for(let n=0;n<e.length;n++)t+=e[n].byteLength;let n=new Uint8Array(t),r=0;for(let t=0;t<e.length;t++)n.set(new Uint8Array(e[t].buffer,e[t].byteOffset,e[t].byteLength),r),r+=e[t].byteLength;return n}class r{pad(r,i){let a=new Uint8Array(i-t);if(a.set(r),i<=t)throw"OAEP message length too small";let s=new Uint32Array([r.byteLength]),c=(new e.Random).fill(new Uint8Array(12)),o=n(s,c,(new e.Keccak800).update(a).update(s).update(c).finalize(16).hash),f=(new e.Keccak800).update(o).finalize(i-t).hash;for(let e=0;e<i-t;e++)a[e]^=f[e];f=(new e.Keccak800).update(a).finalize(t).hash;for(let e=0;e<t;e++)o[e]^=f[e];return{data:n(o,a)}}unpad(n){let r=n.byteLength,i=new Uint8Array(n.buffer,0,t).slice(),a=new Uint8Array(n.buffer,t).slice(),s=(new e.Keccak800).update(a).finalize(t).hash;for(let e=0;e<t;e++)i[e]^=s[e];s=(new e.Keccak800).update(i).finalize(r-t).hash;for(let e=0;e<r-t;e++)a[e]^=s[e];let c=new Uint32Array(i.buffer,0,1),o=new Uint8Array(i.buffer,4,12),f=new Uint8Array(i.buffer,16,16);if((new e.Keccak800).update(a).update(c).update(o).finalize(16).hash.join(",")!=f.join(","))throw"OAEP invalid padding hash";return{data:new Uint8Array(a.buffer,0,c[0])}}}r.seedlen=12,r.hashlen=16,r.hdrlen=t,e.OAEP=r}(Uluru||(Uluru={})),function(e){e.Pbkdf=class{constructor(e=32,t=1e3){this.outputbytes=e,this.iterations=t}compute(t,n=new Uint32Array){let r,i=new Uint8Array(this.outputbytes),a=new e.Keccak800;a.update(n),a.finalize(0);for(let e=0;e<this.iterations;e++){a.update(t),r=a.finalize(this.outputbytes).hash;for(let e=0;e<i.length;e++)i[e]^=r[e]}return{result:i}}}}(Uluru||(Uluru={})),function(e){const t=16300;let n=new Uint32Array(t),r=0;function i(){if(r=0,a.secure)crypto.getRandomValues(n);else for(let e=0,r=t;e<r;e++)n[e]=Math.floor(4294967296*Math.random())}class a{static get secure(){return"object"==typeof crypto}word(){return r>=t&&i(),n[r++]}fill(e){if(ArrayBuffer.isView(e)){i();let r=new Uint32Array(e.buffer,e.byteOffset,e.byteLength>>2);for(let e=0,a=r.length;e<a;e+=t)r.set(new Uint32Array(n.buffer,0,Math.min(a-e,t)),e),i();let a=new Uint8Array(e.buffer,e.byteLength>>2<<2,e.byteLength-(e.byteLength>>2<<2));for(let e=0,t=a.length;e<t;e++)a[e]=this.word()}else for(let t=0,n=e.length;t<n;t++)e[t]=this.word();return e}}a.capacity=t,e.Random=a,i()}(Uluru||(Uluru={})),function(e){const t=BigInt,n=t(1),r=t(0);function i(e){let n=0,r=t(4294967296),i=!0;for(;e;)i=i&&e>r,n+=i?32:1,e>>=t(i?32:1);return n}function a(e,t,r){let i=n;for(;t;)(t&n)==n&&(i=i*e%r),t>>=n,e=e*e%r;return i}function s(i){let a=r,s=new e.Random;for(let e=0;32*e<i;e++)a=a<<t(32)|t(s.word());return a&(n<<t(i))-n}let c=[t(2)];e:for(let e=3;e<1024;e+=2){for(let n=1;n<c.length;n++)if(t(e)%c[n]===BigInt(0))continue e;c.push(t(e))}function o(e,o=6){for(let t=0,n=c.length;t<n;t++)if(e%c[t]==r)return e==c[t];return function(e,c=6){let o,f,h=r,u=e-n,l=Math.min(16,i(e)-1);for(;(u&n)==n;)u>>=n,h++;let d=n,y=e-n;e:for(;c--;)if(o=s(l)+t(5),f=a(o,u,e),f!=d&&f!=y){for(let i=r,s=h-n;i<s;i++){if(f=a(f,t(2),e),f==d)return!1;if(f==y)continue e}return!1}return!0}(e,o)&&function(e,r=6){let c,o=Math.min(16,i(e)-1);for(;r--;)if(c=s(o)+t(5),a(c,e-n,e)!=n)return!1;return!0}(e,o)}function f(e,r=6,i=1e5){let a;for(let c=0;c<i;c++)if(a=s(e)|n|n<<t(e-1),o(a,r))return a;throw"Cannot find a prime"}function h(n){return t("0x"+(new e.enc.Hex).decode(new Uint8Array(n.buffer,n.byteOffset||0,n.byteLength||0)))}function u(t){let n=t.toString(16);return(new e.enc.Hex).encode((n.length%2==1?"0":"")+n)}class l{constructor(e,n){this.E=t(e),this.M=t(n)}static fromBufferViews(e,t){return new this(h(e),h(t))}static fromString(t){let n=t.split("<")[1].split(">")[0].split("|");return this.fromBufferViews((new e.enc.Base64).encode(n[0]),(new e.enc.Base64).encode(n[1]))}toString(){return"<"+(new e.enc.Base64).decode(u(this.E))+"|"+(new e.enc.Base64).decode(u(this.M))+">"}process(e){let t=h(e);if(t>=this.M)throw"Data integer too large";return u(a(t,this.E,this.M))}encrypt(t){t="string"==typeof t?(new e.enc.Utf8).encode(t):t;let n=(i(this.M)>>3)-2-e.OAEP.hdrlen;if(t.byteLength>n)throw"Message too long";return{data:this.process((new e.OAEP).pad(t,n).data)}}decrypt(t){return{data:(new e.OAEP).unpad(this.process(t)).data}}sign(t){t="string"==typeof t?(new e.enc.Utf8).encode(t):t;let n=(new e.Keccak800).update(t).finalize(64).hash;return{data:t,signature:this.encrypt(n).data}}verify(t,n){try{t="string"==typeof t?(new e.enc.Utf8).encode(t):t;let r=(new e.Keccak800).update(t).finalize(64).hash,i=this.decrypt(n).data;return r.join(",")==i.join(",")}catch(e){return!1}}}e.RSAKey=l;const d=t(257),y=["\n==BEGIN ULURU PUBLIC KEY==\n","\n==END ULURU PUBLIC KEY==\n"],w=["\n==BEGIN ULURU PRIVATE KEY==\n","\n==END ULURU PRIVATE KEY==\n"];class p{constructor(e,t){this.public=e,this.private=t}static fromString(e){return new this(l.fromString(e.split(y[0])[1].split(y[1])[0]),l.fromString(e.split(w[0])[1].split(w[1])[0]))}static generate(e){if(!e)return;let t=d,i=f(e>>=1),a=f(e),s=i*a,c=function(e,t){let i,a,s=t,c=r,o=n;for(;e>1;)i=e/t,a=t,t=e%t,e=a,a=c,c=o-i*c,o=a;return o<0?o+s:o}(t,(i-n)*(a-n));return new this(new l(t,s),new l(c,s))}toString(){return y[0]+this.public.toString()+y[1]+"\n"+w[0]+this.private.toString()+w[1]}}p.pubexp=d,p.publicprefix=y,p.privateprefix=w,e.RSAKeyPair=p;const g=h((new e.enc.Base64).encode("///////////JD9qiIWjCNMTGYouA3BzRKQJOCIpnzHQCC76mOxObIlFKCHmONATd75UZs806QxswKwpt8l8UN0/hNW1tUcJF5IW1dmJefsb0TELppjftawv/XLb0Brft7jhr+1qJn6WunyQRfEsf5kkoZlHs5Fs9wgB8uKFjvwWY2kg2HFXTmmkWP6j9JM9fg2VdI9yjrZYcYvNWIIVSu57VKQdwlpZtZww1Tkq8mATxdGwIyhghfDKQXkYuNs474553LBgOhgObJ4Oi7Aeij7XFXfBvTFLJ3ivL9pVYFxg5lUl86pVq5RXSJhiY+gUQFXKOWoqqxC2tMxcNBFB6M6hVIavfHLpk7PuFBFjb7wqK6nFXXQYMfbOXD4Wm4eTHq/WujNsJM9cejJTgSiVhnc7j0iYa0u5r8S/6BtmKCGTYdgJzPshqZFIfKxgXeyAMu+EXV3phXWx3CYjAutlG4gjiT6B05asxQ9tb/OD9EI5LgtEgqSEIARpyPBKnh+bXiHGaEL26WyaZwycYavTiPBqUaDS2FQvaJYPpyirUTOjbu8LbBN6O+S6O/BQfvsqmKHxZR05rwF2ZspZPoJDDoiM7oYZRW+ftH2EpcM7i16+4G912IXBIHNAGkSfVsFqpk7TqmI2P3cGG/7fckKbAj030Nck0BjGZ//////////8=")),U=t(2);e.DiffieHellman=class{constructor(){this.E=s(384)|t(1)<<t(383)}send(){return u(a(U,this.E,g))}receive(e){this.state=a(h(e),this.E,g)}finalize(t){if("bigint"!=typeof this.state)throw"Key exchange cannot finalize without receiving";return new e.Pbkdf(t,10).compute(u(this.state))}}}(Uluru||(Uluru={})),function(e){let t;!function(e){e.Utf8=class{encode(e){if("function"==typeof TextEncoder)return(new TextEncoder).encode(e);let t,n=new Uint8Array(4*e.length),r=0;for(let i=0,a=e.length;i<a;i++)t=e.codePointAt(i),t>4096&&i++,t<=127?n[r++]=t:t<=2047?(n[r++]=192|t>>>6&31,n[r++]=128|63&t):t<=65535?(n[r++]=224|t>>>12&15,n[r++]=128|t>>>6&63,n[r++]=128|63&t):(n[r++]=240|t>>>18&7,n[r++]=128|t>>>12&63,n[r++]=128|t>>>6&63,n[r++]=128|63&t)}decode(e){if(e=new Uint8Array(e.buffer,e.byteOffset,e.byteLength),"function"==typeof TextDecoder)return(new TextDecoder).decode(e);let t,n=[];for(let r=0,i=e.length;r<i;)e[r]<128?n.push(String.fromCharCode(e[r++])):e[r]>=192&&e[r]<224?n.push(String.fromCharCode((31&e[r++])<<6|63&e[r++])):e[r]>=224&&e[r]<240?n.push(String.fromCharCode((15&e[r++])<<12|(63&e[r++])<<6|63&e[r++])):e[r]>=240&&e[r]<247?(t=(7&e[r++])<<18|(63&e[r++])<<12|(63&e[r++])<<6|63&e[r++],n.push(String.fromCodePoint(t))):r++;return n.join("")}}}(t=e.enc||(e.enc={}))}(Uluru||(Uluru={})),"function"==typeof define&&define.amd&&define("Uluru",[],(()=>Uluru)),"undefined"!=typeof module&&(module.exports=Uluru);